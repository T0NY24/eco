<!-- Contenedor principal -->
<div class="intercambio-container">

  <!-- PRODUCTO DESTINO -->
  <ng-container *ngIf="productoDestino; else loadingSkeleton">
    <div class="producto-destino">
      <h2>Intercambio con: {{ productoDestino.title }}</h2>
      <p>{{ productoDestino.description }}</p>
      <p>Categoría: {{ productoDestino.category }}</p>
      <p>Tipo: {{ productoDestino.type }}</p>
      <p>EcoPuntos: {{ productoDestino.ecoPoints }}</p>
      <p>Ubicación: {{ productoDestino.location }}</p>
      <p>Dueño: {{ productoDestino.owner }}</p>
    </div>

    <!-- Lista de productos del usuario -->
    <h3>Selecciona uno de tus productos para ofrecer en intercambio:</h3>
    <div *ngIf="misProductos$ | async as misProductos; else noProductos">
      <div *ngFor="let item of misProductos" class="item-card">
        <input type="radio" name="productoOfrecido" [value]="item.id" [(ngModel)]="productoOfrecidoId" />
        <label>{{ item.title }} - {{ item.description }}</label>
      </div>
    </div>

    <ng-template #noProductos>
      <p>No tienes productos publicados para ofrecer.</p>
    </ng-template>

    <!-- Comentario y valoración -->
    <h3>Deja un comentario y valoración para el intercambio:</h3>
    <textarea [(ngModel)]="comentario" placeholder="Escribe tu comentario aquí..."></textarea>
    <label>Valoración:</label>
    <select [(ngModel)]="valoracion">
      <option *ngFor="let val of [1,2,3,4,5]" [value]="val">{{ val }}</option>
    </select>

    <button (click)="enviarIntercambio()">Enviar Solicitud de Intercambio</button>
  </ng-container>

  <!-- SKELETON / LOADER -->
  <ng-template #loadingSkeleton>
    <div class="skeleton-wrapper">
      
      <!-- Loader central -->
      <div class="loader-wrapper">
        <span class="loader"></span>
      </div>

      <!-- Producto destino skeleton -->
      <div class="producto-destino skeleton">
        <div class="skeleton-line full"></div>
        <div class="skeleton-line medium"></div>
        <div class="skeleton-line medium"></div>
        <div class="skeleton-line short"></div>
        <div class="skeleton-line short"></div>
        <div class="skeleton-line medium"></div>
        <div class="skeleton-line full"></div>
      </div>

      <!-- Lista de productos skeleton -->
      <div class="item-card skeleton" *ngFor="let n of [1,2,3]">
        <div class="skeleton-line full"></div>
        <div class="skeleton-line medium"></div>
      </div>

      <!-- Comentario y valoración skeleton -->
      <div class="skeleton-line full"></div>
      <div class="skeleton-line medium"></div>
      <div class="skeleton-line short"></div>
      <div class="skeleton-line short"></div>
      <div class="skeleton-line medium"></div>

      <!-- Botón skeleton -->
      <div class="skeleton-line short" style="height: 40px; border-radius: 12px;"></div>
    </div>
  </ng-template>
  
</div>
